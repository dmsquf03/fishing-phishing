import pandas as pd

df = pd.read_csv('./keywords_list.csv')
df.head

text = ""

keywords = df['Keywords']
category = df['return']

text_tokens = list(text.split())
category_num = []

#url_dataset_num = []

def extract_keywords(text_tokens, keywords):
    i = 0
    extracted_words = []   # 문자 텍스트 내에 포함되어 있는 키워드를 포함하고 있는 단어 리스트
    key_tokens = []        # 문자 텍스트 내에 포함되어 있는 키워드 리스트
    key_tokens_index = []  # 문자 텍스트 내에 포함되어 있는 키워드가 keywords DataFrame에서 몇번째 인덱스인지
    for word in text_tokens:
        for i in range(len(keywords)):
            if keywords[i] in word:
                print(keywords[i], word)
                extracted_words.append(word)
                key_tokens.append(keywords[i])
                key_tokens_index.append(i)
    
    return key_tokens, key_tokens_index

def find_category(category, key_tokens_index, category_num):
    for index in key_tokens_index:
        category_num.append(category[index])
    category_num = set(category_num)
    category_num = list(category_num)
    return category_num

keywords, keywords_index = extract_keywords(text_tokens, keywords)
print(keywords)
print(keywords_index)

url_dataset_num = find_category(category, keywords_index, category_num)
print(url_dataset_num)
